"use strict";function ownKeys(t,e){var n,i=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)),i}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(e){_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}require.config({baseUrl:"./modules/",paths:{sl:"./list/setLocalData"}}),require(["sl"],function(s){var e=function(){function e(){_classCallCheck(this,e),this.goodList=document.querySelector(".good-list"),this.pageList=document.querySelector(".nowPage"),this.navImg=document.querySelector(".nav"),this.goodDesc=document.querySelector(".goodDesc"),this.goodItem=document.querySelector(".goodItem"),this.switchTab=document.querySelector(".switchTab"),this.xqBox=document.querySelector(".xqms dt ul"),this.xqImgBox=document.querySelector(".xqms dd p"),this.xq={gg:"规格",cd:"产地",scnf:"生产年份",ccff:"储藏方法",bzq:"保质期",dj:"等级",bzgg:"包装规格"},this.init()}return _createClass(e,[{key:"init",value:function(){this.goodList.className+=" list_html",this.urlData=this.urlParse(),this.getDBData(this.urlData)}},{key:"urlParse",value:function(){return _objectSpread(_objectSpread({},location.href.split("?")[1].split("&").reduce(function(e,t){return _objectSpread(_objectSpread({},e),{},_defineProperty({},t.split("=")[0],t.split("=")[1]))},{})),{},{type:"goods_data"})}},{key:"getDBData",value:function(e){var t=this;ajax({type:"GET",url:"http://localhost:3000/api",success:function(e){e.code&&t.renderer_details(e.data)},error:function(e){console.log(e)},search:e})}},{key:"renderer_details",value:function(n){document.title=n.good_title;var e,i='<li><a href="./index.html">首页</a></li>';for(e in n.tags.forEach(function(e){i+='<li>/</li>\n                        <li><a href="javascript:;">'.concat(e,"</a></li>")}),this.pageList.innerHTML=i+'<li>/</li>\n                                                <li><a href="javascript:;">'.concat(n.good_title,"</a></li>"),i="",n.img_list.forEach(function(e,t){i+="<li",i+=t?">":' class="on">',i+='<img src="./images/details/'.concat(e,'" alt=""></li>')}),this.navImg.innerHTML=i,this.goodDesc.innerHTML='<h1 class="title">'.concat(n.good_title,'</h1>\n                                        <p class="info">').concat(n.info||"",'</p>\n                                        <div class="line"></div>\n                                        <div class="goodDescList">\n                                            <div class="scj">市场价<span>￥<em>').concat(n.oldPrice,'.00</em></span></div>\n                                            <div class="zpj">醉品价<span>￥<em>').concat(n.nowPrice,'.00</em></span></div>\n                                            <div class="cx">促销\n                                                <div class="cxTag">\n                                                    <div class="tagInfo">包邮</div>\n                                                    <div class="tagDesc">全场在线支付满59元免运费</div>\n                                                </div>\n                                                <div class="cxTag">\n                                                    <div class="tagInfo">直降</div>\n                                                    <div class="tagDesc">已优惠<i class="youhui">').concat(n.youhui,'</i>元</div>\n                                                </div>\n                                            </div>\n                                            <div class="line"></div>\n                                            <ul class="pp clearfix">\n                                                <li><span class="ppK">品牌</span><span class="ppV">').concat(n.pinpai,'</span></li>\n                                                <li><span class="ppK">净含量</span><span class="ppV">').concat(n.jhl,'</span></li>\n                                                <li><span class="ppK">商品编号</span><span class="ppV">').concat(n.ID,'</span></li>\n                                            </ul>\n                                            <div class="line"></div>\n                                            <div class="sl">数量\n                                                <button class="jian">-</button>\n                                                <input type="text" value="1">\n                                                <button class="plus">+</button>\n                                            </div>\n                                            <button class="addCart">加入购物车</button>\n                                            <div class="line"></div>\n                                            <ul class="fw clearfix">\n                                                <li>服务</li>\n                                                <li>90天商品保价</li>\n                                                <li>30天无理由退货</li>\n                                                <li>10分钟极速退款</li>\n                                            </ul>\n                                        </div>'),this.goodItem.innerHTML='<img src="./images/details/'.concat(n.img_list[0],'" alt="">\n                <div class="itemInfo">\n                    <div class="itemDesc">').concat(n.good_title,'</div>\n                    <div class="itemPrice">￥').concat(n.nowPrice,"</div>\n                </div>"),this.switchTab.innerHTML='<li>详情描述</li>\n                                        <li>评论晒单(<span class="plNum"> '.concat(n.praise," </span>)</li>"),i="",n.xqms.xqms_tags)i+='<li title="'.concat(this.xq[e],"：").concat(n.xqms.xqms_tags[e],'">\n                            <span class="xqK">').concat(this.xq[e],'：</span>\n                            <span class="xqV">').concat(n.xqms.xqms_tags[e],"</span>\n                        </li>");this.xqBox.innerHTML=i,i="",n.xqms.xqms_imgs.forEach(function(e){i+='<img src="./images/details/'.concat(e,'">')}),this.xqImgBox.innerHTML=i,addEvent(document.querySelector(".sl"),"click",function(e){e=getTarget(e);"jian"===e.className?1<e.nextElementSibling.value&&e.nextElementSibling.value--:"plus"===e.className&&e.previousElementSibling.value++}),addEvent(document.querySelector(".sl").children[1],"input",function(){this.value=this.value.replace(/[^\d]/g,"")}),addEvent(document.querySelector(".sl").children[1],"blur",function(){Number(this.value)||(this.value=1)}),addEvent(document.querySelector(".addCart"),"click",function(){var e,t;"ok"===getCookie("isLogin")?((e=document.querySelector(".addCartTip")).style.display="block",setTimeout(function(){e.style.display="none"},1e3),s({goodID:n.ID,price:n.nowPrice,num:Number(document.querySelector(".sl").children[1].value)}),t=JSON.parse(getCookie("goods")),document.querySelector(".cartNum").innerHTML=t.reduce(function(e,t){return e+t.num},0)):(setCookie("href",location.href),location.href="./login.html")}),addEvent(document.querySelector(".suspAddCart"),"click",function(){var e,t;"ok"===getCookie("isLogin")?((e=document.querySelector(".addCartTip")).style.display="block",setTimeout(function(){e.style.display="none"},1e3),s({goodID:n.ID,price:n.nowPrice,num:Number(document.querySelector(".sl").children[1].value),from:"goods_data",link:location.href}),t=JSON.parse(getCookie("goods")),document.querySelector(".cartNum").innerHTML=t.reduce(function(e,t){return e+t.num},0)):(setCookie("href",location.href),location.href="./login.html")})}}]),e}(),t=function(){function e(){_classCallCheck(this,e),this.sBox=document.querySelector(".smallBox"),this.sBoxW=parseInt(getStyle(this.sBox,"width")),this.sBoxH=parseInt(getStyle(this.sBox,"height")),this.oSpan=document.querySelector(".smallBox span"),this.bBox=document.querySelector(".bigBox"),this.bBoxImg=this.bBox.firstElementChild,this.MagnifyingAddEvent()}return _createClass(e,[{key:"oSpanInit",value:function(){this.oSpanLine=this.sBoxW*this.ratio,this.oSpan.style.width=this.oSpanLine+"px",this.oSpan.style.height=this.oSpanLine+"px"}},{key:"MagnifyingAddEvent",value:function(){var t=this;addEvent(this.sBox,"mouseenter",function(){t.show()}),addEvent(this.sBox,"mouseleave",function(){t.hide()}),addEvent(this.sBox,"mousemove",function(e){e=getEvent(e);t.refreshSpan({x:e.offsetX,y:e.offsetY})})}},{key:"show",value:function(){this.oSpan.style.display="block",this.bBox.style.display="block",this.ratio=this.bBox.offsetWidth/this.bBoxImg.offsetWidth,this.oSpanInit()}},{key:"hide",value:function(){this.oSpan.style.display="none",this.bBox.style.display="none"}},{key:"refreshSpan",value:function(e){var t=e.x-this.oSpanLine/2,n=e.y-this.oSpanLine/2;t<0&&(t=0),n<0&&(n=0),e.x>this.sBoxW-this.oSpanLine/2&&(t=this.sBoxW-this.oSpanLine),e.y>this.sBoxH-this.oSpanLine/2&&(n=this.sBoxH-this.oSpanLine),this.oSpan.style.left=t+"px",this.oSpan.style.top=n+"px",this.refreshBBoxImg(t/this.ratio,n/this.ratio)}},{key:"refreshBBoxImg",value:function(e,t){this.bBoxImg.style.left=-e+"px",this.bBoxImg.style.top=-t+"px"}}]),e}(),n=function(){function e(){_classCallCheck(this,e),this.sBox=document.querySelector(".smallBox"),this.sBoxImg=document.querySelector(".smallBox img"),this.bBox=document.querySelector(".bigBox"),this.bBoxImg=document.querySelector(".bigBox img"),this.nav=document.querySelector(".nav"),this.aLi=document.querySelectorAll(".nav li"),this.btns=document.querySelectorAll(".picNav button"),this.navImgs=Array.from(this.nav.children).map(function(e){return e.firstElementChild.src.replace(/http:\/\/localhost:3000/,".")}),this.nowIndex=0,this.sBoxImg.src=this.aLi[0].firstChild.src,this.bBoxImg.src=this.aLi[0].firstChild.src,this.NavAddEvnet()}return _createClass(e,[{key:"NavAddEvnet",value:function(){var n=this;this.aLi.forEach(function(e,t){addEvent(e,"click",function(){n.clearNavStyle(t),n.addNavStyle(),n.replaceImg()})}),this.btns.forEach(function(e,t){addEvent(e,"click",function(){t?n.nextImg():n.prevImg(),n.addNavStyle(),n.replaceImg()})}),addEvent(document,"selectstart",function(e){stopDefault(getEvent(e))})}},{key:"prevImg",value:function(){this.clearNavStyle(0===this.nowIndex?0:this.nowIndex-1)}},{key:"nextImg",value:function(){this.clearNavStyle(this.nowIndex===this.aLi.length-1?this.aLi.length-1:this.nowIndex+1)}},{key:"clearNavStyle",value:function(e){this.aLi[this.nowIndex].className="",this.nowIndex=e}},{key:"addNavStyle",value:function(){this.aLi[this.nowIndex].className="on"}},{key:"replaceImg",value:function(){this.sBoxImg.src=this.navImgs[this.nowIndex],this.bBoxImg.src=this.navImgs[this.nowIndex]}}]),e}(),i=function(){function e(){_classCallCheck(this,e),this.susp=document.querySelector(".suspension"),this.fixedAddEvent()}return _createClass(e,[{key:"fixedAddEvent",value:function(){var e=this;this.judge(),addEvent(document,"scroll",function(){e.judge()})}},{key:"judge",value:function(){800<=document.documentElement.scrollTop?this.show():this.hide()}},{key:"show",value:function(){this.susp.className.includes("fixed")||(this.susp.className+=" fixed"),elementAnimation(this.susp,{top:0})}},{key:"hide",value:function(){elementAnimation(this.susp,{top:-60}),this.susp.className="suspension"}}]),e}();setTimeout(function(){new e,setTimeout(function(){new i,new n,new t},100)},50)});